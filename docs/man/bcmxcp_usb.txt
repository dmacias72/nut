BCMXCP_USB(8)
=============

NAME
----
bcmxcp_usb - Experimental driver for UPSes supporting the BCM/XCP protocol over USB

NOTE
----
This man page only documents the hardware-specific features of the
bcmxcp_usb driver.  For information about the core driver, see
linkman:nutupsdrv[8].
This driver is a variant of the serial driver bcmxcp and uses the same core code.

SUPPORTED HARDWARE
------------------
This driver should recognize all BCM/XCP-compatible UPSes that are connected
via USB.  It has been developed and tested on Powerware PW3501 hardware. It also has
been tested on PW5110 hardware.

EXTRA ARGUMENTS
---------------

This driver supports the following optional settings in the    
linkman:ups.conf[5].

*shutdown_delay=*'delay'::
The number of seconds that the UPS should wait between receiving the 
shutdown command and actually shutting off.

*vendorid* = 'regex'::
*productid* = 'regex'::
*vendor* = 'regex'::
*product* = 'regex'::
*serial* = 'regex'::
Select a specific UPS, in case there is more than one connected via USB.
Each option specifies an extended regular expression (see *regex(7)*) that must
match the UPS's entire vendor/product/serial string (minus any surrounding
whitespace), or the whole 4-digit hexadecimal code for vendorid and productid.
Try *-DD* for finding out the strings to match.
+
Examples:

- `-x vendor="Foo.Corporation.*"`
- `-x vendorid=051d*` (APC)
- `-x product=".*(Smart|Back)-?UPS.*"`

*bus* = 'regex'::
Select a UPS on a specific USB bus or group of buses.
The argument is a regular expression that must match the bus name where the UPS
is connected (e.g. `bus="002"`, `bus="00[2-3]"`).

DEFAULT VALUES FOR THE EXTRA ARGUMENTS
--------------------------------------
*shutdown_delay =*'120'

INSTANT COMMANDS
----------------
This driver supports the following Instant Commands:

*shutdown.return*::
Turn off the load and return when power is back. 

*shutdown.stayoff*::
Turn off the load and remain off.

*test.battery.start*::
Start a battery test.

TODO LIST
---------

*Report UPS alarm status*::
BCM/XCP supports reporting a wide range of UPS alarm conditions.

*Report UPS statistics information*::
BCM/XCP supports reporting of UPS statistics data.

EXPERIMENTAL DRIVER
-------------------
This driver has been tagged experimental, even if it has been reported
to be stable. Thus it is not suitable for production systems and it is
not built by default. This is mainly due to the fact that it is a
new driver.

INSTALLATION
------------
This driver is not built by default.  You can build it by using
"configure --with-usb=yes". Note that it will also install other USB
drivers.

You also need to install manually the hotplug files (libhidups and
libhid.usermap), generally in etc/hotplug/usb/, to address the
permission settings problem. Lastly note that the libhidups file
must have execution flag set (ie using chmod +x ...).

IMPLEMENTATION
--------------
Selecting a specific UPS
~~~~~~~~~~~~~~~~~~~~~~~~

The driver ignores the "port" value in *ups.conf*. Unlike previous versions of
this driver, it is now possible to control multiple UPS units simultaneously
with this driver, provided they can be distinguished by setting some combination
of the "vendor", "product", "serial", "vendorid", "productid" and "bus" options.
For instance:

	[pw3105]
		driver = bcmxcp_usb
		port = auto
		vendorid = 0592
	[hp-t500]
		driver = bcmxcp_usb
		port = auto
		vendorid = 03f0
		productid = 1f01
	[hp-t750]
		driver = bcmxcp_usb
		port = auto
		vendorid = 03f0
		productid = 1f02

KNOWN ISSUES AND BUGS
---------------------
"Got EPERM: Operation not permitted upon driver startup"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You have forgotten to install the hotplug files, as explained
in the INSTALLATION section above. Don't forget to restart
hotplug so that it applies these changes.

AUTHOR
------
Tore Ã˜rpetveit <tore@orpetveit.net>,
Wolfgang Ocker <weo@weo1.de>

SEE ALSO
--------

The core driver:
~~~~~~~~~~~~~~~~
linkman:nutupsdrv[8]

Internet resources:
~~~~~~~~~~~~~~~~~~~
The NUT (Network UPS Tools) home page: http://www.networkupstools.org/
